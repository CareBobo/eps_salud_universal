<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Doctor Dashboard - EPS Salud Universal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
      body {
        font-family: 'Times New Roman', serif;
        background-color: #121212;
        color: #f0f0f0;
      }
      .sidebar {
        background-color: #1f1f1f;
      }
      .sidebar h3 {
        color: rgb(255, 109, 36);
        font-size: 2rem;
        font-weight: 900;
        text-align: center;
        text-shadow: 0 0 5px #39ff14, 0 0 10px #39ff14, 0 0 20px #39ff14, 0 0 40px #0f0, 0 0 80px #0f0;
      }
      .sidebar a,
      .navbar .nav-link,
      .navbar a.p-3 {
        color: #39ff14 !important; /* Verde neón visible */
        text-decoration: none;
        font-size: 1.2rem;
        font-weight: bold;
        text-shadow: 0 0 5px #39ff14, 0 0 10px #39ff14, 0 0 20px #39ff14, 0 0 40px #0f0, 0 0 80px #0f0;
        transition: all 0.3s ease;
      }
      .sidebar a:hover,
      .navbar .nav-link:hover,
      .navbar a.p-3:hover {
        color: white !important;
        text-shadow: 0 0 10px #39ff14, 0 0 20px #39ff14, 0 0 30px #39ff14, 0 0 60px #0f0, 0 0 100px #0f0;
      }
      .content-section {
        display: none;
      }
      .content-section.active {
        display: block;
      }
      .carousel-item img {
        width: 100%;
        height: auto;
        object-fit: contain;
        background-color: #000;
      }
      .text-section {
        margin-top: 2rem;
      }
      .btn-sm {
        padding: 0.25rem 0.5rem;
        font-size: 0.75rem;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
      <h3 class="text-center py-3 border-bottom border-secondary">EPS Salud Universal</h3>

      {% if role in ['doctor', 'admin'] %}
        <a href="#" onclick="showSection('consultas')" class="p-3 nav-link" data-section="consultas">Consultas</a>
        <a href="#" onclick="showSection('consultarCitasDoctor')" class="p-3 nav-link" data-section="consultarCitasDoctor">Citas por Doctor</a>
        <a href="#" onclick="showSection('agregarConsulta')" class="p-3 nav-link" data-section="agregarConsulta">Agregar Consulta</a>
        <a href="#" onclick="showSection('agendarhistoriaClinica')" class="p-3 nav-link" data-section="agendarhistoriaClinica">Agendar Historia Clinica</a>
        <a href="#" onclick="showSection('historiaClinica')" class="p-3 nav-link" data-section="historiaClinica">Historia Clínica</a>
      {% endif %}
      <a href="{{ url_for('logout') }}" class="btn btn-danger mt-auto mx-3 mb-3">Cerrar Sesión</a>
    </nav>

    <main class="flex-grow-1 p-4" style="min-height: 100vh; overflow-y:auto;">
      <!-- Consultas -->
      <section id="consultas" class="content-section">
        <h2>Lista de Consultas</h2>
        <button class="btn btn-primary mb-3" onclick="fetchConsultas()">Cargar Consultas</button>
        <ul class="list-group" id="consultaList"></ul>
      </section>

      <!-- Agregar / Actualizar Consulta -->
      <section id="agregarConsulta" class="content-section">
        <h2>Agregar Consulta</h2>
        <form id="formConsulta">
          <input type="hidden" id="consultaId" />
          <div class="mb-3">
            <label class="form-label">ID Cita</label>
            <input type="number" id="idCita" class="form-control" required />
          </div>
          <div class="mb-3">
            <label class="form-label">Fecha Atención</label>
            <input type="date" id="fechaAtencion" class="form-control" required />
          </div>
          <div class="mb-3">
            <label class="form-label">Síntomas</label>
            <textarea id="sintomas" class="form-control" rows="3" required></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Tratamiento</label>
            <textarea id="tratamiento" class="form-control" rows="3" required></textarea>
          </div>
          <button type="submit" class="btn btn-success">Guardar Consulta</button>
          <button type="button" id="cancelUpdateConsulta" class="btn btn-secondary ms-2" style="display:none;">Cancelar</button>
          <p id="mensajeConsulta" class="mt-2"></p>
        </form>
      </section>

      <!-- Agendar Historia Clínica -->
      <section id="agendarhistoriaClinica" class="content-section">
        <h2>Agendar Historia Clínica</h2>
        <form id="formHistoriaNueva" class="mb-3">
          <div class="mb-3">
            <label class="form-label">ID Paciente</label>
            <input type="number" id="historiaNuevaPacienteId" class="form-control" required />
          </div>
          <div class="mb-3">
            <label class="form-label">Fecha de Creación</label>
            <input type="date" id="historiaNuevaFecha" class="form-control" required />
          </div>
          <div class="mb-3">
            <label class="form-label">Descripción</label>
            <textarea id="historiaNuevaDescripcion" class="form-control" rows="3" required></textarea>
          </div>
          <button type="submit" class="btn btn-success">Crear Historia Clínica</button>
          <p id="mensajeHistoriaNueva" class="mt-2"></p>
        </form>
      </section>

      <!-- Historia Clínica -->
      <section id="historiaClinica" class="content-section">
        <h2>Historia Clínica</h2>
        <form id="formHistoriaClinica" class="mb-3">
          <div class="mb-3">
            <label class="form-label">ID Paciente</label>
            <input type="number" id="historiaPacienteId" class="form-control" required />
          </div>
          <button type="submit" class="btn btn-primary">Consultar Historia Clínica</button>
        </form>
        <ul class="list-group" id="listaHistoriaClinica"></ul>
      </section>

      <!-- Consultar Citas por Doctor y Fecha -->
      <section id="consultarCitasDoctor" class="content-section">
        <h2>Consultar Citas por Doctor y Fecha</h2>
        <form id="formConsultarCitas" class="mb-3">
          <div class="mb-3">
            <label class="form-label">ID Doctor</label>
            <input type="number" id="doctorIdConsulta" class="form-control" required />
          </div>
          <div class="mb-3">
            <label class="form-label">Fecha</label>
            <input type="date" id="fechaConsulta" class="form-control" required />
          </div>
          <button type="submit" class="btn btn-primary">Consultar Citas</button>
        </form>
        <ul class="list-group" id="listaCitasDoctor"></ul>
      </section>

      <!-- Carrusel -->
      <div id="carouselEPS" class="carousel slide mb-5" data-bs-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img src="{{ url_for('static', filename='imagenes/carrusel1.webp') }}" class="d-block w-100 carousel-img" alt="EPS 1" />
          </div>
          <div class="carousel-item">
            <img src="{{ url_for('static', filename='imagenes/carrusel2.webp') }}" class="d-block w-100 carousel-img" alt="EPS 2" />
          </div>
          <div class="carousel-item">
            <img src="{{ url_for('static', filename='imagenes/carrusel3.webp') }}" class="d-block w-100 carousel-img" alt="EPS 3" />
          </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselEPS" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselEPS" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
      </div>

      <!-- Textos extra -->
      <div class="text-section">
        <h2>Nuestra Misión</h2>
        <p>Brindar servicios de salud integrales con calidad, eficiencia y calidez humana, comprometidos con el bienestar de nuestros usuarios.</p>

        <h2 class="mt-4">Visión</h2>
        <p>Ser la EPS líder en atención médica en el país, reconocida por su excelencia en el servicio y el compromiso con la salud de la comunidad.</p>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
  </body>
</html>
